<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>HeavenLight SERVER</title>

<style>
body{
    margin:0;
    background:black;
    color:#00ff99;
    font-family:monospace;
    overflow:hidden;
}

#matrixCanvas{
    position:fixed;
    top:0;
    left:0;
    width:100%;
    height:100%;
    z-index:-1;
    background:black;
}

#warningOverlay{
    position:fixed;
    width:100%;
    height:100%;
    background:rgba(255,0,0,0.3);
    display:none;
    animation:blink 0.4s infinite;
    pointer-events:none;
}

@keyframes blink{
    0%{opacity:0.1;}
    50%{opacity:0.8;}
    100%{opacity:0.1;}
}

#intro{ padding:60px; white-space:pre-line; font-size:20px; }
#startBtn{
    display:none;
    padding:12px 25px;
    font-size:18px;
    background:black;
    color:#00ff99;
    border:1px solid #00ff99;
    cursor:pointer;
}

#gameBox{ display:none; text-align:center; margin-top:80px; }

button{
    background:black;
    color:#00ff99;
    border:1px solid #00ff99;
    padding:10px 20px;
    margin:8px;
    cursor:pointer;
}

button:hover{ background:#003322; }

#answerInput{
    padding:8px;
    font-size:16px;
    background:black;
    color:#00ff99;
    border:1px solid #00ff99;
}

#hackerMsg{
    position:fixed;
    bottom:30px;
    width:100%;
    text-align:center;
    color:red;
    font-size:22px;
    display:none;
}

@media (max-width: 768px){
    #intro{ padding:30px; font-size:16px; }
    #gameBox{ margin-top:40px; }
    h1{ font-size:20px; }
    button{
        width:90%;
        font-size:16px;
        padding:14px;
    }
    #answerInput{
        width:85%;
        font-size:16px;
    }
}
</style>
</head>

<body>

<!-- âœ… ì—¬ê¸° ì¶”ê°€ë¨ (ë¬¸ì œ í•´ê²° ë¶€ë¶„) -->
<audio id="bgm" loop>
    <source src="https://actions.google.com/sounds/v1/ambiences/digital_watch_alarm_long.ogg" type="audio/ogg">
</audio>

<canvas id="matrixCanvas"></canvas>
<div id="warningOverlay"></div>
<div id="intro"></div>
<div id="hackerMsg"></div>

<center>
<button id="startBtn" onclick="startGame()">â–¶ ë³µêµ¬ ì‘ì „ ì‹œì‘</button>
</center>

<div id="gameBox">
<h1>ğŸ•µï¸ ë§ì”€ ì„œë²„ ë³µêµ¬ ë¯¸ì…˜</h1>
<p id="score"></p>
<p id="question"></p>
<div id="options"></div>
<input type="text" id="answerInput" style="display:none;">
<br>
<button id="submitBtn" onclick="submitAnswer()" style="display:none;">ì…ë ¥</button>
</div>

<script>

// ğŸµ ë°°ê²½ìŒ
const bgm = document.getElementById("bgm");

// ğŸš¨ ê²½ê³ ìŒ
const alertSound = new Audio("https://actions.google.com/sounds/v1/alarms/beep_short.ogg");

function redAlert(){
    document.getElementById("warningOverlay").style.display="block";
    alertSound.play();
    setTimeout(()=>{
        document.getElementById("warningOverlay").style.display="none";
    },2000);
}

// (ì´í•˜ JS ì½”ë“œëŠ” ì›ë˜ ê·¸ëŒ€ë¡œ â€” ìƒëµ ì—†ì´ ìœ ì§€)
// í•´ì»¤ ë©˜íŠ¸
const hackerLines=[
"??? : ì•„ì§ ëë‚œ ê²Œ ì•„ë‹ˆë‹¤...",
"??? : ê¸°ì–µì´ íë¦¿í•œ ê²ƒ ê°™ì€ë°?",
"??? : ì„œë²„ ë³µêµ¬? ì›ƒê¸°ì§€ ë§ˆë¼.",
"??? : ì ìˆ˜ëŠ” ë‚´ê°€ ê´€ë¦¬í•œë‹¤.",
"??? : ë‹¤ìŒ ë¬¸ì œì—ì„œ ë¬´ë„ˆì§ˆ ê²ƒì´ë‹¤."
];

const hackerMocking=[
"??? : í•˜í•˜... ê·¸ê²Œ ì •ë‹µì´ë¼ê³ ?",
"??? : ì„¤êµë¥¼ ë“¤ì€ ê²Œ ë§ë‚˜?",
"??? : ì„œë²„ëŠ” ì•„ì§ ì ê²¨ ìˆë‹¤.",
"??? : ì´ ì •ë„ë¡œ ë‚  ì´ê¸¸ ìˆ˜ ìˆì„ê¹Œ?",
"??? : ë‹¤ì‹œ ìƒê°í•´ë´ë¼."
];

function showHackerMessage(text){
    let box=document.getElementById("hackerMsg");
    box.innerText=text;
    box.style.display="block";
    setTimeout(()=>box.style.display="none",3000);
}

// ===== ì¸íŠ¸ë¡œ =====
let introText=
"âš  ì„œë²„ í•´í‚¹ ê°ì§€ âš \n\n"+
" í•˜ëŠ˜ì˜ ë¹› êµíšŒì— ë§ì”€ ì½”ë“œê°€ ì‚¬ë¼ì¡Œë‹¤...\n\n"+
"??? : ë§ì”€ ê¸°ë¡ì„ ì‚­ì œí•˜ê² ë‹¤...\n"+
"??? : ì•„ë¬´ë„ ë§ì”€ì„ ê¸°ì–µ ëª»í•˜ê²Œ ë§Œë“¤ê² ì–´...\n\n";

let i=0;
function typeWriter(){
    if(i<introText.length){
        document.getElementById("intro").innerHTML+=introText.charAt(i);
        i++;
        setTimeout(typeWriter,30);
    }else{
        redAlert();
        setTimeout(()=>document.getElementById("startBtn").style.display="block",1500);
    }
}
typeWriter();

// ===== í€´ì¦ˆ =====
const quiz=[
{type:"mc",question:"[1ë‹¨ê³„] í•˜ë‚˜ë‹˜ê»˜ì„œ ë¨¹ì§€ ë§ë¼ê³  í•˜ì‹  ë‚˜ë¬´ëŠ”?",
options:["1) ìƒëª…ë‚˜ë¬´","2) ë™ì‚° ì¤‘ì•™ì˜ ë‚˜ë¬´","3) í¬ë„ë‚˜ë¬´","4) ë¬´í™”ê³¼ë‚˜ë¬´"],answer:"2"},
{type:"mc",question:"[2ë‹¨ê³„] ì•„ë‹´ê³¼ í•˜ì™€ê°€ ì£„ í›„ í•œ í–‰ë™ì´ ì•„ë‹Œ ê²ƒì€?",
options:["1) ë²—ì€ ì¤„ ì•Œì•˜ë‹¤","2) ë¬´í™”ê³¼ ì ì˜· ì œì‘","3) í•˜ë‚˜ë‹˜ì„ í”¼í•´ ìˆ¨ìŒ","4) íšŒê°œ ê¸°ë„"],answer:"4"},
{type:"mc",question:"[3ë‹¨ê³„] ì£„ í›„ ì•„ë‹´ê³¼ í•˜ì™€ëŠ”?",
options:["1) ì„œë¡œë¥¼ íƒ“í•¨","2) ì¦‰ì‹œ ìš©ì„œ êµ¬í•¨","3) ì•„ë¬´ ì¼ë„ ì—†ìŒ","4) ë‹¤ì‹œ ì—´ë§¤ ë¨¹ìŒ"],answer:"1"},
{type:"mc",question:"[4ë‹¨ê³„] ì£„ì˜ ê²°ê³¼ëŠ” ë¬´ì—‡ì¸ê°€?",
options:["1) ê¸°ì¨","2) ì˜ì›í•œ ìƒëª…","3) ì‚¬ë§(ê´€ê³„ ë‘ì ˆ)","4) ìƒê¸‰"],answer:"3"},
{type:"text",question:"[ìµœì¢… ë³µêµ¬] í•˜ë‚˜ë‹˜ê³¼ ê´€ê³„ê°€ ê¹¨ì–´ì§„ ì´ìœ ëŠ”?",answer:"ì£„"}
];

let current=0;
let score=0;

function startGame(){
    bgm.play();
    document.getElementById("intro").style.display="none";
    document.getElementById("startBtn").style.display="none";
    document.getElementById("gameBox").style.display="block";
    document.getElementById("score").innerText="ì ìˆ˜: 0";
    loadQuestion();
}

function loadQuestion(){
    const q=quiz[current];
    document.getElementById("question").innerText=q.question;
    document.getElementById("options").innerHTML="";
    document.getElementById("answerInput").style.display="none";
    document.getElementById("submitBtn").style.display="none";

    if(q.type==="mc"){
        q.options.forEach((opt,index)=>{
            let btn=document.createElement("button");
            btn.innerText=opt;
            btn.onclick=()=>checkAnswer((index+1).toString());
            document.getElementById("options").appendChild(btn);
        });
    }else{
        document.getElementById("answerInput").style.display="inline";
        document.getElementById("submitBtn").style.display="inline";
    }

    if(Math.random()<0.5){
        setTimeout(()=>{
            redAlert();
            showHackerMessage(hackerLines[Math.floor(Math.random()*hackerLines.length)]);
        },1500);
    }
}

function submitAnswer(){
    let input=document.getElementById("answerInput").value.trim();
    checkAnswer(input);
}

function checkAnswer(ans){
    let correct=quiz[current].answer;
    let isCorrect=(quiz[current].type==="text")?ans.includes("ì£„"):ans===correct;

    if(isCorrect){
        score+=20;
        document.getElementById("score").innerText="ì ìˆ˜: "+score;
        current++;
        if(current>=quiz.length){ winGame(); }
        else{ loadQuestion(); }
    }else{
        redAlert();
        showHackerMessage(hackerMocking[Math.floor(Math.random()*hackerMocking.length)]);
        score-=5;
        document.getElementById("score").innerText="ì ìˆ˜: "+score;
    }

    document.getElementById("answerInput").value="";
}

function winGame(){
    bgm.pause();
    document.body.innerHTML=
    "<h1 style='color:gold;text-align:center;margin-top:150px;'>ğŸ‰ SEASON 1 CLEAR ğŸ‰</h1>"+
    "<h2 style='text-align:center;'>ìµœì¢… ì ìˆ˜: "+score+"ì </h2>"+
    "<h2 style='text-align:center;color:red;margin-top:40px;'>ì‹œì¦Œ2 í”„ë¦¬í€„ ì˜ìƒ ì¬ìƒ ì¤‘...</h2>";
    setTimeout(season2Preview,4000);
}

function season2Preview(){
document.body.innerHTML=
"<div style='color:#00ff99;font-family:monospace;padding:60px;font-size:20px;white-space:pre-line;'>"+
"ì„œë²„ ì‹¬ì¸µ ìŠ¤ìº”...\n\n"+
"??? : ë„ˆí¬ëŠ” ì²« ë²ˆì§¸ ê´€ë¬¸ì„ í†µê³¼í–ˆë‹¤.\n\n"+
"í•˜ì§€ë§Œ ì§„ì§œ ì•”í˜¸ëŠ” ì•„ì§ ë‚¨ì•„ìˆë‹¤.\n\n"+
"SEASON 2 : THE HIDDEN CHAPTER\n\n"+
"ê³„ì†í•˜ë ¤ë©´... ë‹¤ì‹œ ëª¨ì—¬ë¼.\n"+
"</div>";
}

// ===== ì„ ëª…í•œ ë§¤íŠ¸ë¦­ìŠ¤ =====
const canvas=document.getElementById("matrixCanvas");
const ctx=canvas.getContext("2d");

function resizeCanvas(){
    const dpr=window.devicePixelRatio||1;
    canvas.width=window.innerWidth*dpr;
    canvas.height=window.innerHeight*dpr;
    canvas.style.width=window.innerWidth+"px";
    canvas.style.height=window.innerHeight+"px";
    ctx.setTransform(1,0,0,1,0,0);
    ctx.scale(dpr,dpr);
}
resizeCanvas();

window.addEventListener("resize",resizeCanvas);

const letters="010101010101";
const fontSize=16;
let columns=Math.floor(window.innerWidth/fontSize);
let drops=Array(columns).fill(1);

function drawMatrix(){
    ctx.fillStyle="rgba(0,0,0,0.05)";
    ctx.fillRect(0,0,canvas.width,canvas.height);

    ctx.fillStyle="#00ff99";
    ctx.font=fontSize+"px monospace";

    for(let i=0;i<drops.length;i++){
        const text=letters[Math.floor(Math.random()*letters.length)];
        ctx.fillText(text,i*fontSize,drops[i]*fontSize);

        if(drops[i]*fontSize>window.innerHeight && Math.random()>0.975){
            drops[i]=0;
        }
        drops[i]++;
    }
}
setInterval(drawMatrix,33);

</script>
</body>
</html>
